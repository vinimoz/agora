{"version":3,"file":"agora-dashboard.mjs","sources":["../../../src/views/Dashboard.vue","../../../src/dashboard.ts"],"sourcesContent":["<!--\n  - SPDX-FileCopyrightText: 2022 Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<script setup lang=\"ts\">\nimport { onMounted } from 'vue';\nimport { generateUrl } from '@nextcloud/router';\nimport { showError } from '@nextcloud/dialogs';\nimport { t } from '@nextcloud/l10n';\nimport DOMPurify from 'dompurify';\n\nimport NcDashboardWidget from '@nextcloud/vue/components/NcDashboardWidget';\n\nimport { InquiryTypesUI } from '../helpers/modules/InquiryHelper.ts';\nimport { AgoraAppIcon } from '../components/AppIcons/index.ts';\nimport { Logger } from '../helpers/index.ts';\nimport { useInquiriesStore } from '../stores/inquiries.ts';\n\nconst dashboardWidgetProperties = {\n  emptyContentMessage: t('agora', 'No inquiries found for this category'),\n  showMoreText: t('agora', 'Relevant inquiries')\n};\n\n\nconst inquiriesStore = useInquiriesStore();\n\n/**\n * Load the inquiries\n */\nfunction loadInquiries(): void {\n  Logger.debug('Loading inquiries in dashboard widget');\n\n  try {\n    inquiriesStore.load();\n  } catch {\n    showError(t('agora', 'Error setting dashboard list'));\n  }\n}\n\nonMounted(() => {\n  loadInquiries();\n});\n</script>\n\n<template>\n  <div>\n    <NcDashboardWidget\n      :items=\"inquiriesStore.dashboardList\"\n      :empty-content-message=\"dashboardWidgetProperties.emptyContentMessage\"\n      :show-more-text=\"dashboardWidgetProperties.showMoreText\"\n      :loading=\"inquiriesStore.inquiriesLoading\"\n    >\n      <template #emptyContentIcon>\n        <AgoraAppIcon />\n      </template>\n\n      <template #default=\"{ item }\">\n        <a :href=\"generateUrl(`/apps/agora/inquiry/${item.id}`)\">\n          <div class=\"inquiry-item__item\">\n            <div class=\"type-icon\">\n              <component :is=\"InquiryTypesUI[item.type].icon\" />\n            </div>\n\n            <div class=\"item__title\">\n              <div class=\"item__title__title\">\n                {{ item.title }}\n              </div>\n\n              <div class=\"item__title__description\">\n                {{\n                  DOMPurify.sanitize(item.description\n                    ? item.description\n                    : t('agora', 'No description provided'))\n                }}\n              </div>\n            </div>\n          </div>\n        </a>\n      </template>\n    </NcDashboardWidget>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.inquiry-item__item {\n  display: flex;\n  padding: 4px 0;\n\n  &.active {\n    background-color: var(--color-primary-element-light);\n  }\n\n  &:hover {\n    background-color: var(--color-background-hover);\n  }\n}\n\n.item__title {\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n\n  * {\n    display: block;\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n  }\n\n  .item__title__description {\n    opacity: 0.5;\n  }\n}\n\n.item__icon-spacer {\n  width: 44px;\n  min-width: 44px;\n}\n</style>\n","/**\n * SPDX-FileCopyrightText: 2022 Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { createApp } from 'vue';\nimport { pinia } from './stores/index.ts';\n\nimport Dashboard from './views/Dashboard.vue';\nimport './assets/scss/agora-icon.scss';\n\n// Vue.config.devtools = import.meta.env.MODE !== 'production'\n/** global: OCA */\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  // @ts-expect-error: Name not found error\n  OCA.Dashboard.register('agora', (el) => {\n    const AgoraDashboard = createApp(Dashboard).use(pinia).mount(el);\n\n    return AgoraDashboard;\n  });\n});\n"],"names":["dashboardWidgetProperties","t","inquiriesStore","useInquiriesStore","loadInquiries","Logger","showError","onMounted","_createElementBlock","_createVNode","_unref","NcDashboardWidget","AgoraAppIcon","_withCtx","item","_createElementVNode","generateUrl","_hoisted_2","_hoisted_3","_openBlock","_createBlock","_resolveDynamicComponent","InquiryTypesUI","_hoisted_4","_hoisted_5","_toDisplayString","_hoisted_6","DOMPurify","el","createApp","Dashboard","pinia"],"mappings":";;;;;;AAmBA,QAAMA,IAA4B,EAChC,qBAAqBC,EAAE,SAAS,sCAAsC,GACtE,cAAcA,EAAE,SAAS,oBAAoB,EAAA,GAIzCC,IAAiBC,EAAA;AAKvB,WAASC,IAAsB;AAC7BC,MAAO,MAAM,uCAAuC;AAEpD,QAAI;AACFH,QAAe,KAAA;AAAA,IACjB,QAAQ;AACNI,QAAUL,EAAE,SAAS,8BAA8B,CAAC;AAAA,IACtD;AAAA,EACF;AAEA,SAAAM,EAAU,MAAM;AACdH,MAAA;AAAA,EACF,CAAC,mBAICI,EAmCM,OAAA,MAAA,CAlCJC,EAiCoBC,EAAAC,CAAA,GAAA,EAhCjB,OAAOD,EAAAR,CAAA,EAAe,eACtB,yBAAuBF,EAA0B,qBACjD,kBAAgBA,EAA0B,cAC1C,SAASU,EAAAR,CAAA,EAAe,iBAAA,KAEd,oBACT,MAAgB,CAAhBO,EAAgBC,EAAAE,CAAA,CAAA,CAAA,IAGP,SAAOC,EAChB,CAoBI,EArBgB,MAAAC,QAAI,CACxBC,EAoBI,KAAA,EApBA,MAAML,EAAAM,CAAA,EAAW,uBAAwBF,EAAK,EAAE,EAAA,EAAA,IAClDC,EAkBM,OAlBNE,GAkBM,CAjBJF,EAEM,OAFNG,GAEM,EADJC,EAAA,GAAAC,EAAkDC,EAAlCX,EAAAY,CAAA,EAAeR,EAAK,IAAI,EAAE,IAAI,CAAA,EAAA,IAGhDC,EAYM,OAZNQ,GAYM,CAXJR,EAEM,OAFNS,GAEMC,EADDX,EAAK,KAAK,GAAA,CAAA,GAGfC,EAMM,OANNW,GAMMD,EAJFf,EAAAiB,CAAA,EAAU,SAASb,EAAK,cAAkCA,EAAK,cAAkCJ,EAAAT,CAAA,EAAC,SAAA,yBAAA,CAAA,CAAA,GAAA,CAAA,CAAA;;ACzDpH,SAAS,iBAAiB,oBAAoB,MAAM;AAElD,MAAI,UAAU,SAAS,SAAU2B,OACRC,EAAUC,CAAS,EAAE,IAAIC,CAAK,EAAE,MAAMH,CAAE,CAGhE;AACH,CAAC;"}