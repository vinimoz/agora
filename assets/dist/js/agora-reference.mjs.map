{"version":3,"file":"agora-reference.mjs","sources":["../../../src/components/Base/modules/BadgeSmallDiv.vue","../../../src/views/Reference.vue","../../../src/agora-reference.ts"],"sourcesContent":["<!--\n  - SPDX-FileCopyrightText: 2018 Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<script setup lang=\"ts\">\nconst { tag = 'span' } = defineProps<{ tag?: string }>();\n</script>\n\n<template>\n  <Component :is=\"tag\" class=\"badge-small\">\n    <slot name=\"icon\" />\n    <span v-if=\"$slots.default\">\n      <slot />\n    </span>\n  </Component>\n</template>\n\n<style scoped lang=\"scss\">\n#body-user .badge-small {\n  display: flex;\n  flex: 0 0 fit-content;\n  align-items: center;\n  gap: 5px;\n  border: 2px solid;\n  border-radius: var(--border-radius-pill) !important;\n  text-align: center;\n  font-size: 0.9em;\n  overflow: hidden;\n  padding: 0px 8px !important;\n  margin: 0 !important;\n  min-height: 1.4rem;\n\n  span {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  h2 & {\n    font-size: 0.6em;\n  }\n\n  &.error {\n    background-color: rgba(var(--color-error-rgb), 0.2);\n    border-color: var(--color-error);\n  }\n\n  &.success {\n    background-color: rgba(var(--color-success-rgb), 0.2);\n    border-color: var(--color-success);\n  }\n\n  &.warning {\n    background-color: rgba(var(--color-warning-rgb), 0.2) !important;\n    border-color: var(--color-warning);\n  }\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2022 Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<script setup lang=\"ts\">\nimport NcUserBubble from '@nextcloud/vue/components/NcUserBubble';\nimport { AgoraAppIcon } from '../components/AppIcons';\nimport ExpirationIcon from 'vue-material-design-icons/CalendarEnd.vue';\nimport BadgeSmallDiv from '../components/Base/modules/BadgeSmallDiv.vue';\nimport { t } from '@nextcloud/l10n';\nimport { DateTime } from 'luxon';\n\ntype RichObject = {\n  id: number;\n  inquiry: {\n    id: number;\n    title: string;\n    description: string;\n    ownerDisplayName: string;\n    ownerId: string;\n    url: string;\n    participated: false;\n    childsList: number;\n    supportsList: number;\n    expiry: number;\n    expired: boolean;\n  };\n};\n\ninterface Props {\n  richObject?: RichObject;\n}\n\nconst { richObject } = defineProps<Props>();\n\nconst expiryClass = richObject?.inquiry?.expiry\n  ? DateTime.fromMillis(richObject.inquiry.expiry * 1000).diffNow('hours')\n    .hours < 36\n    ? 'warning'\n    : 'success'\n  : '';\n</script>\n\n<template>\n  <div v-if=\"richObject\" class=\"agora_widget\">\n    <div class=\"widget_header\">\n      <AgoraAppIcon :size=\"20\" class=\"title-icon\" />\n      <a class=\"title\" :href=\"richObject.inquiry.url\" target=\"_blank\">\n        {{ richObject.inquiry.title }}\n      </a>\n      <BadgeSmallDiv v-if=\"richObject.inquiry.participated\" class=\"success\">\n        {{ t('agora', 'participated') }}\n      </BadgeSmallDiv>\n      <BadgeSmallDiv v-else-if=\"richObject.inquiry.expired\" class=\"error\">\n        {{ t('agora', 'closed') }}\n      </BadgeSmallDiv>\n      <BadgeSmallDiv\n        v-else-if=\"richObject.inquiry.expiry > 0\"\n        :class=\"expiryClass\"\n      >\n        <template #icon>\n          <ExpirationIcon :size=\"16\" />\n        </template>\n        {{ DateTime.fromMillis(richObject.inquiry.expiry * 1000).toRelative() }}\n      </BadgeSmallDiv>\n    </div>\n    <div class=\"description\">\n      <span class=\"clamped\">\n        {{ richObject.inquiry.description }}\n      </span>\n    </div>\n    <div v-if=\"richObject.inquiry.ownerId\" class=\"widget_footer\">\n      <span>{{ t('agora', 'By:') }}</span>\n      <NcUserBubble\n        :user=\"richObject.inquiry.ownerId\"\n        :display-name=\"richObject.inquiry.ownerDisplayName\"\n      />\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.agora_widget {\n  padding: 0.6rem;\n}\n\n.widget_header,\n.widget_footer {\n  display: flex;\n  column-gap: 0.3rem;\n}\n\n.badge-small {\n  flex: 0;\n}\n\n.agora_app_icon {\n  flex: 0 0 1.4rem;\n}\n\n.title {\n  flex: 1;\n  font-weight: bold;\n  padding-inline-start: 0.6rem;\n  text-wrap: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.description {\n  margin-inline-start: 1.4rem;\n  padding: 0.6rem;\n}\n\n.owner {\n  margin-inline-start: 1.4rem;\n  padding-inline-start: 0.6rem;\n}\n\n.clamped {\n  display: -webkit-box !important;\n  -webkit-line-clamp: 4;\n  line-clamp: 4;\n  -webkit-box-orient: vertical;\n  text-wrap: wrap;\n  overflow: clip !important;\n  text-overflow: ellipsis !important;\n  padding: 0 !important;\n}\n</style>\n","/**\n * SPDX-FileCopyrightText: 2022 Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { createApp } from 'vue';\nimport { pinia } from './stores/index.ts';\nimport { registerWidget } from '@nextcloud/vue/components/NcRichText';\nimport Reference from './views/Reference.vue';\nimport './assets/scss/agora-icon.scss';\n\nregisterWidget(\n  'agora_reference_widget',\n  async (el, { richObject }) => {\n    const AgoraReference = createApp(Reference, {\n      richObject\n    })\n      .use(pinia)\n      .mount(el);\n    return AgoraReference;\n  },\n  (el) => el.classList.add('nc-agora-reference-widget'),\n  {}\n);\n"],"names":["_openBlock","_createBlock","_resolveDynamicComponent","tag","_renderSlot","_ctx","$slots","_createElementBlock","_hoisted_1","expiryClass","__props","DateTime","richObject","_createElementVNode","_hoisted_2","_createVNode","_unref","AgoraAppIcon","_hoisted_3","BadgeSmallDiv","t","ExpirationIcon","_toDisplayString","_hoisted_4","_hoisted_5","_hoisted_6","NcUserBubble","registerWidget","el","createApp","Reference","pinia"],"mappings":";;;;;;;oBAUEA,EAAA,GAAAC,EAKYC,EALIC,EAAAA,GAAG,GAAA,EAAE,OAAM,iBAAa,aACtC,MAAoB,CAApBC,EAAoBC,EAAA,QAAA,QAAA,CAAA,GAAA,QAAA,IAAA,GACRC,EAAAA,OAAO,gBAAnBC,EAEO,QAAAC,GAAA,CADLJ,EAAQC,EAAA,QAAA,WAAA,CAAA,GAAA,QAAA,IAAA,CAAA;;ACuBd,QAAMI,IAAcC,cAAY,SAAS,SACrCC,EAAS,WAAWD,EAAA,WAAW,QAAQ,SAAS,GAAI,EAAE,QAAQ,OAAO,EACpE,QAAQ,KACP,YACA,YACF;mBAISE,EAAAA,cAAXZ,EAAA,GAAAO,EAkCM,OAlCNC,GAkCM,CAjCJK,EAoBM,OApBNC,GAoBM,CAnBJC,EAA8CC,EAAAC,CAAA,GAAA,EAA/B,MAAM,IAAI,OAAM,aAAA,IAC/BJ,EAEI,KAAA,EAFD,OAAM,SAAS,MAAMD,EAAAA,WAAW,QAAQ,KAAK,QAAO,SAAA,KAClDA,EAAAA,WAAW,QAAQ,KAAK,GAAA,GAAAM,CAAA,GAERN,EAAAA,WAAW,QAAQ,qBAAxCX,EAEgBkB,GAAA,UAFsC,OAAM,UAAA,gBAC1D,MAAgC,KAA7BH,EAAAI,CAAA,EAAC,SAAA,cAAA,CAAA,GAAA,CAAA,CAAA,eAEoBR,EAAAA,WAAW,QAAQ,gBAA7CX,EAEgBkB,GAAA,UAFsC,OAAM,QAAA,gBAC1D,MAA0B,KAAvBH,EAAAI,CAAA,EAAC,SAAA,QAAA,CAAA,GAAA,CAAA,CAAA,eAGOR,EAAAA,WAAW,QAAQ,SAAM,UADtCX,EAQgBkB,GAAA,UANb,SAAOH,EAAAP,CAAA,CAAW,EAAA,KAER,QACT,MAA6B,CAA7BM,EAA6BM,GAAA,EAAZ,MAAM,IAAE,CAAA,eAChB,MACX,GADW,MACXC,EAAGN,EAAAL,CAAA,EAAS,WAAWC,EAAAA,WAAW,QAAQ,SAAM,GAAA,EAAS,WAAA,CAAU,GAAA,CAAA,CAAA,4CAGvEC,EAIM,OAJNU,GAIM,CAHJV,EAEO,QAFPW,GAEOF,EADFV,aAAW,QAAQ,WAAW,GAAA,CAAA,CAAA,IAG1BA,EAAAA,WAAW,QAAQ,WAA9BZ,KAAAO,EAMM,OANNkB,GAMM,CALJZ,EAAoC,gBAA3BG,EAAAI,CAAA,EAAC,SAAA,KAAA,CAAA,GAAA,CAAA,GACVL,EAGEC,EAAAU,CAAA,GAAA,EAFC,MAAMd,EAAAA,WAAW,QAAQ,SACzB,gBAAcA,EAAAA,WAAW,QAAQ,iBAAA;;ACjE1Ce,EACE,0BACA,OAAOC,GAAI,EAAE,YAAAhB,QACYiB,EAAUC,GAAW,EAC1C,YAAAlB,EAAA,CACD,EACE,IAAImB,CAAK,EACT,MAAMH,CAAE,GAGZA,OAAOA,EAAG,UAAU,IAAI,2BAA2B,GACpD,CAAA,CACF;"}