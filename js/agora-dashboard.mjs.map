{"version":3,"file":"agora-dashboard.mjs","sources":["../src/views/Dashboard.vue","../src/dashboard.ts"],"sourcesContent":["<!--\n  - SPDX-FileCopyrightText: 2022 Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<script setup lang=\"ts\">\nimport { onMounted } from 'vue'\nimport { generateUrl } from '@nextcloud/router'\nimport { showError } from '@nextcloud/dialogs'\nimport { t } from '@nextcloud/l10n'\nimport DOMPurify from 'dompurify'\n\nimport NcDashboardWidget from '@nextcloud/vue/components/NcDashboardWidget'\n\nimport { InquiryTypesUI } from '../helpers/modules/InquiryHelper.ts'\nimport { AgoraAppIcon } from '../components/AppIcons/index.ts'\nimport { Logger } from '../helpers/index.ts'\nimport { useInquiriesStore } from '../stores/inquiries.ts'\n\nconst dashboardWidgetProperties = {\n  emptyContentMessage: t('agora', 'No inquiries found for this category'),\n  showMoreText: t('agora', 'Relevant inquiries'),\n}\n\nconst inquiriesStore = useInquiriesStore()\n\n/**\n * Load the inquiries\n */\nfunction loadInquiries(): void {\n  Logger.debug('Loading inquiries in dashboard widget')\n\n  try {\n    inquiriesStore.load()\n  } catch {\n    showError(t('agora', 'Error setting dashboard list'))\n  }\n}\n\nonMounted(() => {\n  loadInquiries()\n})\n</script>\n\n<template>\n  <div>\n    <NcDashboardWidget\n      :items=\"inquiriesStore.dashboardList\"\n      :empty-content-message=\"dashboardWidgetProperties.emptyContentMessage\"\n      :show-more-text=\"dashboardWidgetProperties.showMoreText\"\n      :loading=\"inquiriesStore.inquiriesLoading\"\n    >\n      <template #emptyContentIcon>\n        <AgoraAppIcon />\n      </template>\n\n      <template #default=\"{ item }\">\n        <a :href=\"generateUrl(`/apps/agora/inquiry/${item.id}`)\">\n          <div class=\"inquiry-item__item\">\n            <div class=\"type-icon\">\n              <component :is=\"InquiryTypesUI[item.type].icon\" />\n            </div>\n\n            <div class=\"item__title\">\n              <div class=\"item__title__title\">\n                {{ item.title }}\n              </div>\n\n              <div class=\"item__title__description\">\n                {{\n                  DOMPurify.sanitize(\n                    item.description ? item.description : t('agora', 'No description provided')\n                  )\n                }}\n              </div>\n            </div>\n          </div>\n        </a>\n      </template>\n    </NcDashboardWidget>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.inquiry-item__item {\n  display: flex;\n  padding: 4px 0;\n\n  &.active {\n    background-color: var(--color-primary-element-light);\n  }\n\n  &:hover {\n    background-color: var(--color-background-hover);\n  }\n}\n\n.item__title {\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n\n  * {\n    display: block;\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n  }\n\n  .item__title__description {\n    opacity: 0.5;\n  }\n}\n\n.item__icon-spacer {\n  width: 44px;\n  min-width: 44px;\n}\n</style>\n","/**\n * SPDX-FileCopyrightText: 2022 Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { createApp } from 'vue'\nimport { pinia } from './stores/index.ts'\n\nimport Dashboard from './views/Dashboard.vue'\nimport './assets/scss/agora-icon.scss'\n\n// Vue.config.devtools = import.meta.env.MODE !== 'production'\n/** global: OCA */\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  // @ts-expect-error: Name not found error\n  OCA.Dashboard.register('agora', (el) => {\n    const AgoraDashboard = createApp(Dashboard).use(pinia).mount(el)\n\n    return AgoraDashboard\n  })\n})\n"],"names":["t","_createElementBlock","_createVNode","_withCtx","_createElementVNode","_openBlock","_createBlock","_resolveDynamicComponent","_toDisplayString"],"mappings":";;;;;;;;;;AAmBA,UAAM,4BAA4B;AAAA,MAChC,qBAAqBA,UAAE,SAAS,sCAAsC;AAAA,MACtE,cAAcA,UAAE,SAAS,oBAAoB;AAAA,IAAA;AAG/C,UAAM,iBAAiB,kBAAA;AAKvB,aAAS,gBAAsB;AAC7B,aAAO,MAAM,uCAAuC;AAEpD,UAAI;AACF,uBAAe,KAAA;AAAA,MACjB,QAAQ;AACN,kBAAUA,UAAE,SAAS,8BAA8B,CAAC;AAAA,MACtD;AAAA,IACF;AAEA,cAAU,MAAM;AACd,oBAAA;AAAA,IACF,CAAC;;;;;;;;;;;;;;;;;;;AAiBc,MAAA,aAAA,EAAA,OAAM,qBAAA;AACJ,MAAA,aAAA,EAAA,OAAM,YAAA;AAIN,MAAA,aAAA,EAAA,OAAM,cAAA;AACJ,MAAA,aAAA,EAAA,OAAM,qBAAA;AAIN,MAAA,aAAA,EAAA,OAAM,2BAAA;;sBAvBvBC,mBAmCM,OAAA,MAAA;AAAA,IAlCJC,YAiCoB,OAAA,mBAAA,GAAA;AAAA,MAhCjB,OAAO,OAAA,eAAe;AAAA,MACtB,yBAAuB,OAAA,0BAA0B;AAAA,MACjD,kBAAgB,OAAA,0BAA0B;AAAA,MAC1C,SAAS,OAAA,eAAe;AAAA,IAAA,GAAA;AAAA,MAEd,kBAAgBC,QACzB,MAAgB;AAAA,QAAhBD,YAAgB,OAAA,cAAA,CAAA;AAAA,MAAA,CAAA;AAAA,MAGP,SAAOC,QAChB,CAoBI,EArBgB,WAAI;AAAA,QACxBC,gBAoBI,KAAA;AAAA,UApBA,MAAM,OAAA,YAAW,uBAAwB,KAAK,EAAE,EAAA;AAAA,QAAA,GAAA;AAAA,UAClDA,gBAkBM,OAlBN,YAkBM;AAAA,YAjBJA,gBAEM,OAFN,YAEM;AAAA,eAAAC,UAAA,GADJC,YAAkDC,wBAAlC,OAAA,eAAe,KAAK,IAAI,EAAE,IAAI,CAAA;AAAA,YAAA,CAAA;AAAA,YAGhDH,gBAYM,OAZN,YAYM;AAAA,cAXJA;AAAAA,gBAEM;AAAA,gBAFN;AAAA,gBAEMI,gBADD,KAAK,KAAK;AAAA,gBAAA;AAAA;AAAA,cAAA;AAAA,cAGfJ;AAAAA,gBAMM;AAAA,gBANN;AAAA,gBAMMI,gBAJF,OAAA,UAAU;AAAA,kBAA8B,KAAK,cAAc,KAAK,cAAc,OAAA,EAAC,SAAA,yBAAA;AAAA,gBAAA,CAAA;AAAA;;;;;;;;;;;;;ACxDjG,SAAS,iBAAiB,oBAAoB,MAAM;AAElD,MAAI,UAAU,SAAS,SAAS,CAAC,OAAO;AACtC,UAAM,iBAAiB,UAAU,SAAS,EAAE,IAAI,KAAK,EAAE,MAAM,EAAE;AAE/D,WAAO;AAAA,EACT,CAAC;AACH,CAAC;"}