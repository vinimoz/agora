{"version":3,"file":"agora-reference.mjs","sources":["../src/components/Base/modules/BadgeSmallDiv.vue","../src/views/Reference.vue","../src/agora-reference.ts"],"sourcesContent":["<!--\n  - SPDX-FileCopyrightText: 2018 Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<script setup lang=\"ts\">\nconst { tag = 'span' } = defineProps<{ tag?: string }>()\n</script>\n\n<template>\n  <Component :is=\"tag\" class=\"badge-small\">\n    <slot name=\"icon\" />\n    <span v-if=\"$slots.default\">\n      <slot />\n    </span>\n  </Component>\n</template>\n\n<style scoped lang=\"scss\">\n#body-user .badge-small {\n  display: flex;\n  flex: 0 0 fit-content;\n  align-items: center;\n  gap: 5px;\n  border: 2px solid;\n  border-radius: var(--border-radius-pill) !important;\n  text-align: center;\n  font-size: 0.9em;\n  overflow: hidden;\n  padding: 0px 8px !important;\n  margin: 0 !important;\n  min-height: 1.4rem;\n\n  span {\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  h2 & {\n    font-size: 0.6em;\n  }\n\n  &.error {\n    background-color: rgba(var(--color-error-rgb), 0.2);\n    border-color: var(--color-error);\n  }\n\n  &.success {\n    background-color: rgba(var(--color-success-rgb), 0.2);\n    border-color: var(--color-success);\n  }\n\n  &.warning {\n    background-color: rgba(var(--color-warning-rgb), 0.2) !important;\n    border-color: var(--color-warning);\n  }\n}\n</style>\n","<!--\n  - SPDX-FileCopyrightText: 2022 Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<script setup lang=\"ts\">\nimport NcUserBubble from '@nextcloud/vue/components/NcUserBubble'\nimport { AgoraAppIcon } from '../components/AppIcons'\nimport ExpirationIcon from 'vue-material-design-icons/CalendarEnd.vue'\nimport BadgeSmallDiv from '../components/Base/modules/BadgeSmallDiv.vue'\nimport { t } from '@nextcloud/l10n'\nimport { DateTime } from 'luxon'\n\ntype RichObject = {\n  id: number\n  inquiry: {\n    id: number\n    title: string\n    description: string\n    ownerDisplayName: string\n    ownerId: string\n    url: string\n    participated: false\n    childsList: number\n    supportsList: number\n    expiry: number\n    expired: boolean\n  }\n}\n\ninterface Props {\n  richObject?: RichObject\n}\n\nconst { richObject } = defineProps<Props>()\n\nconst expiryClass = richObject?.inquiry?.expiry\n  ? DateTime.fromMillis(richObject.inquiry.expiry * 1000).diffNow('hours').hours < 36\n    ? 'warning'\n    : 'success'\n  : ''\n</script>\n\n<template>\n  <div v-if=\"richObject\" class=\"agora_widget\">\n    <div class=\"widget_header\">\n      <AgoraAppIcon :size=\"20\" class=\"title-icon\" />\n      <a class=\"title\" :href=\"richObject.inquiry.url\" target=\"_blank\">\n        {{ richObject.inquiry.title }}\n      </a>\n      <BadgeSmallDiv v-if=\"richObject.inquiry.participated\" class=\"success\">\n        {{ t('agora', 'participated') }}\n      </BadgeSmallDiv>\n      <BadgeSmallDiv v-else-if=\"richObject.inquiry.expired\" class=\"error\">\n        {{ t('agora', 'closed') }}\n      </BadgeSmallDiv>\n      <BadgeSmallDiv v-else-if=\"richObject.inquiry.expiry > 0\" :class=\"expiryClass\">\n        <template #icon>\n          <ExpirationIcon :size=\"16\" />\n        </template>\n        {{ DateTime.fromMillis(richObject.inquiry.expiry * 1000).toRelative() }}\n      </BadgeSmallDiv>\n    </div>\n    <div class=\"description\">\n      <span class=\"clamped\">\n        {{ richObject.inquiry.description }}\n      </span>\n    </div>\n    <div v-if=\"richObject.inquiry.ownerId\" class=\"widget_footer\">\n      <span>{{ t('agora', 'By:') }}</span>\n      <NcUserBubble\n        :user=\"richObject.inquiry.ownerId\"\n        :display-name=\"richObject.inquiry.ownerDisplayName\"\n      />\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.agora_widget {\n  padding: 0.6rem;\n}\n\n.widget_header,\n.widget_footer {\n  display: flex;\n  column-gap: 0.3rem;\n}\n\n.badge-small {\n  flex: 0;\n}\n\n.agora_app_icon {\n  flex: 0 0 1.4rem;\n}\n\n.title {\n  flex: 1;\n  font-weight: bold;\n  padding-inline-start: 0.6rem;\n  text-wrap: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.description {\n  margin-inline-start: 1.4rem;\n  padding: 0.6rem;\n}\n\n.owner {\n  margin-inline-start: 1.4rem;\n  padding-inline-start: 0.6rem;\n}\n\n.clamped {\n  display: -webkit-box !important;\n  -webkit-line-clamp: 4;\n  line-clamp: 4;\n  -webkit-box-orient: vertical;\n  text-wrap: wrap;\n  overflow: clip !important;\n  text-overflow: ellipsis !important;\n  padding: 0 !important;\n}\n</style>\n","/**\n * SPDX-FileCopyrightText: 2022 Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { createApp } from 'vue'\nimport { pinia } from './stores/index.ts'\nimport { registerWidget } from '@nextcloud/vue/components/NcRichText'\nimport Reference from './views/Reference.vue'\nimport './assets/scss/agora-icon.scss'\n\nregisterWidget(\n  'agora_reference_widget',\n  async (el, { richObject }) => {\n    const AgoraReference = createApp(Reference, {\n      richObject,\n    })\n      .use(pinia)\n      .mount(el)\n    return AgoraReference\n  },\n  (el) => el.classList.add('nc-agora-reference-widget'),\n  {}\n)\n"],"names":["_openBlock","_createBlock","_resolveDynamicComponent","_withCtx","_renderSlot","_createElementBlock","_hoisted_1","_createCommentVNode","_createElementVNode","_createVNode","_toDisplayString","_createTextVNode","_normalizeClass"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAUE,SAAAA,UAAA,GAAAC,YAKYC,wBALI,OAAA,GAAG,GAAA,EAAE,OAAM,iBAAa;AAAA,IAAA,SAAAC,QACtC,MAAoB;AAAA,MAApBC,WAAoB,KAAA,QAAA,QAAA,CAAA,GAAA,QAAA,IAAA;AAAA,MACR,KAAA,OAAO,wBAAnBC,mBAEO,QAAAC,cAAA;AAAA,QADLF,WAAQ,KAAA,QAAA,WAAA,CAAA,GAAA,QAAA,IAAA;AAAA,MAAA,CAAA,KAAAG,mBAAA,QAAA,IAAA;AAAA;;;;;;;;;;;;;ACuBd,UAAM,cAAc,oBAAY,SAAS,SACrC,SAAS,WAAW,mBAAW,QAAQ,SAAS,GAAI,EAAE,QAAQ,OAAO,EAAE,QAAQ,KAC7E,YACA,YACF;;;;;;;;;;;;;;;;EAIqB,OAAM;;AACtB,MAAA,aAAA,EAAA,OAAM,gBAAA;;AAkBN,MAAA,aAAA,EAAA,OAAM,cAAA;AACH,MAAA,aAAA,EAAA,OAAM,UAAA;;;EAIyB,OAAM;;;SAxBpC,OAAA,cAAAP,UAAA,GAAXK,mBA+BM,OA/BN,YA+BM;AAAA,IA9BJG,gBAiBM,OAjBN,YAiBM;AAAA,MAhBJC,YAA8C,OAAA,cAAA,GAAA;AAAA,QAA/B,MAAM;AAAA,QAAI,OAAM;AAAA,MAAA,CAAA;AAAA,MAC/BD,gBAEI,KAAA;AAAA,QAFD,OAAM;AAAA,QAAS,MAAM,kBAAW,QAAQ;AAAA,QAAK,QAAO;AAAA,MAAA,GAAAE,gBAClD,OAAA,WAAW,QAAQ,KAAK,GAAA,GAAA,UAAA;AAAA,MAER,OAAA,WAAW,QAAQ,gBAAAV,UAAA,GAAxCC,YAEgB,OAAA,eAAA,GAAA;AAAA,QAAA,KAAA;AAAA,QAFsC,OAAM;AAAA,MAAA,GAAA;AAAA,yBAC1D,MAAgC;AAAA,UAAAU;AAAAA,4BAA7B,OAAA,EAAC,SAAA,cAAA,CAAA;AAAA,YAAA;AAAA;AAAA,UAAA;AAAA,QAAA,CAAA;AAAA;;YAEoB,OAAA,WAAW,QAAQ,wBAA7CV,YAEgB,OAAA,eAAA,GAAA;AAAA,QAAA,KAAA;AAAA,QAFsC,OAAM;AAAA,MAAA,GAAA;AAAA,yBAC1D,MAA0B;AAAA,UAAAU;AAAAA,4BAAvB,OAAA,EAAC,SAAA,QAAA,CAAA;AAAA,YAAA;AAAA;AAAA,UAAA;AAAA,QAAA,CAAA;AAAA;;YAEoB,OAAA,WAAW,QAAQ,SAAM,KAAAX,aAAnDC,YAKgB,OAAA,eAAA,GAAA;AAAA,QAAA,KAAA;AAAA,QAL0C,OAAKW,eAAE,OAAA,WAAW;AAAA,MAAA,GAAA;AAAA,QAC/D,MAAIT,QACb,MAA6B;AAAA,UAA7BM,YAA6B,OAAA,gBAAA,GAAA,EAAZ,MAAM,GAAA,CAAE;AAAA,QAAA,CAAA;AAAA,yBAChB,MACX;AAAA,UAAAE;AAAAA,YADW,MACXD,gBAAG,OAAA,SAAS,WAAW,kBAAW,QAAQ,SAAM,KAAS,WAAA,CAAU;AAAA,YAAA;AAAA;AAAA,UAAA;AAAA,QAAA,CAAA;AAAA;;;;IAGvEF,gBAIM,OAJN,YAIM;AAAA,MAHJA;AAAAA,QAEO;AAAA,QAFP;AAAA,QAEOE,gBADF,OAAA,WAAW,QAAQ,WAAW;AAAA,QAAA;AAAA;AAAA,MAAA;AAAA,IAAA,CAAA;AAAA,IAG1B,OAAA,WAAW,QAAQ,WAAAV,UAAA,GAA9BK,mBAMM,OANN,YAMM;AAAA,MALJG;AAAAA,QAAoC;AAAA,QAAA;AAAA,QAAAE,gBAA3B,OAAA,EAAC,SAAA,KAAA,CAAA;AAAA,QAAA;AAAA;AAAA,MAAA;AAAA,MACVD,YAGE,OAAA,cAAA,GAAA;AAAA,QAFC,MAAM,kBAAW,QAAQ;AAAA,QACzB,gBAAc,kBAAW,QAAQ;AAAA,MAAA,GAAA,MAAA,GAAA,CAAA,QAAA,cAAA,CAAA;AAAA;;;;AC7D1C;AAAA,EACE;AAAA,EACA,OAAO,IAAI,EAAE,iBAAiB;AAC5B,UAAM,iBAAiB,UAAU,WAAW;AAAA,MAC1C;AAAA,IAAA,CACD,EACE,IAAI,KAAK,EACT,MAAM,EAAE;AACX,WAAO;AAAA,EACT;AAAA,EACA,CAAC,OAAO,GAAG,UAAU,IAAI,2BAA2B;AAAA,EACpD,CAAA;AACF;"}