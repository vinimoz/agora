{"version":3,"file":"StyleSettings-qgw6mAVl.chunk.mjs","sources":["../src/stores/preferences.ts","../src/components/Settings/UserSettings/FeatureSettings.vue","../src/components/Settings/UserSettings/StyleSettings.vue"],"sourcesContent":["/**\n * SPDX-FileCopyrightText: 2024 Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\nimport { defineStore } from 'pinia'\nimport { CalendarAPI, UserSettingsAPI } from '../Api/index.ts'\nimport { Logger } from '../helpers/index.ts'\nimport { AxiosError } from '@nextcloud/axios'\n\nexport type ViewMode = 'table-view' | 'list-view'\n\nexport type UserPreferences = {\n  calendarPeek: boolean\n  checkCalendars: string[]\n  checkCalendarsHoursBefore: number\n  checkCalendarsHoursAfter: number\n  defaultViewInquiry: ViewMode\n  inquiryCombo: number[]\n  relevantOffset: number\n  useNewInquiryDialogInNavigation: boolean\n  useNewInquiryInInquiryist: boolean\n  useCommentsAlternativeStyling: boolean\n  useAlternativeStyling: boolean\n  verboseInquiriesList: boolean\n}\n\nexport type SessionSettings = {\n  manualViewInquiry: '' | ViewMode\n}\n\nexport type Calendar = {\n  key: string\n  name: string\n  calendarUri: string\n  displayColor: string\n  permissions: number\n}\n\nexport type Preferences = {\n  user: UserPreferences\n  session: SessionSettings\n  availableCalendars: Calendar[]\n}\n\nexport const usePreferencesStore = defineStore('preferences', {\n  state: (): Preferences => ({\n    user: {\n      calendarPeek: false,\n      checkCalendars: [],\n      checkCalendarsHoursBefore: 0,\n      checkCalendarsHoursAfter: 0,\n      defaultViewInquiry: 'table-view',\n      inquiryCombo: [],\n      relevantOffset: 30,\n      useNewInquiryDialogInNavigation: false,\n      useNewInquiryInInquiryist: false,\n      useCommentsAlternativeStyling: false,\n      useAlternativeStyling: false,\n      verboseInquiriesList: false,\n    },\n    session: {\n      manualViewInquiry: '',\n    },\n    availableCalendars: [],\n  }),\n\n  getters: {\n    viewInquiry(state): ViewMode {\n      if (state.session.manualViewInquiry) {\n        return state.session.manualViewInquiry\n      }\n      if (window.innerWidth > 480) {\n        return state.user.defaultViewInquiry\n      }\n      return 'list-view'\n    },\n\n    useNcAppNavigationNew(state): boolean {\n      return !state.user.useNewInquiryDialogInNavigation && !state.user.useNewInquiryInInquiryist\n    },\n\n    useActionAddInquiryInNavigation(state): boolean {\n      return state.user.useNewInquiryDialogInNavigation && !state.user.useNewInquiryInInquiryist\n    },\n  },\n\n  actions: {\n    setCalendars(payload: { calendars: Calendar[] }) {\n      this.availableCalendars = payload.calendars\n    },\n\n    addCheckCalendar(calendar: Calendar) {\n      this.user.checkCalendars.push(calendar.key)\n      this.write()\n    },\n\n    removeCheckCalendar(calendar: Calendar) {\n      const index = this.user.checkCalendars.indexOf(calendar.key)\n      if (index !== -1) {\n        this.user.checkCalendars.splice(index, 1)\n      }\n      this.write()\n    },\n\n    setViewInquiry(viewMode: ViewMode) {\n      this.session.manualViewInquiry = viewMode\n    },\n\n    async load(): Promise<void> {\n      try {\n        const response = await UserSettingsAPI.getUserSettings()\n        this.$patch({ user: response.data.preferences })\n      } catch (error) {\n        if ((error as AxiosError)?.code === 'ERR_CANCELED') {\n          return\n        }\n        this.$reset()\n        throw error\n      }\n    },\n\n    async write(): Promise<void> {\n      try {\n        const response = await UserSettingsAPI.writeUserSettings(this.user)\n        this.$patch({ user: response.data.preferences })\n      } catch (error) {\n        if ((error as AxiosError)?.code === 'ERR_CANCELED') {\n          return\n        }\n        Logger.error('Error writing preferences', {\n          error,\n          preferences: this.user,\n        })\n        throw error\n      }\n    },\n\n    async getCalendars() {\n      try {\n        const response = await CalendarAPI.getCalendars()\n        // this.availableCalendars = response.data.calendars\n        this.setCalendars({ calendars: response.data.calendars })\n        return response\n      } catch (error) {\n        if ((error as AxiosError)?.code === 'ERR_CANCELED') {\n          return\n        }\n        throw error\n      }\n    },\n  },\n})\n","<!--\n  - SPDX-FileCopyrightText: 2018 Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<script setup>\nimport { computed } from 'vue'\nimport { InputDiv } from '../../Base/index.ts'\nimport { t } from '@nextcloud/l10n'\n\nimport NcCheckboxRadioSwitch from '@nextcloud/vue/components/NcCheckboxRadioSwitch'\n\nimport { usePreferencesStore } from '../../../stores/preferences.ts'\n\nconst preferencesStore = usePreferencesStore()\n\nconst defaultViewInquiry = computed({\n  get() {\n    return preferencesStore.user.defaultViewInquiry === 'list-view'\n  },\n  set(value) {\n    preferencesStore.user.defaultViewInquiry = value ? 'list-view' : 'table-view'\n  },\n})\n</script>\n\n<template>\n  <div>\n    <div class=\"user_settings\">\n      <NcCheckboxRadioSwitch\n        v-model=\"defaultViewInquiry\"\n        type=\"switch\"\n        @update:model-value=\"preferencesStore.write()\"\n      >\n        {{ t('agora', 'Proposal agora inquiry default view to list view') }}\n      </NcCheckboxRadioSwitch>\n      <div class=\"settings_details\">\n        {{\n          t(\n            'agora',\n            'Check this, if you prefer to display text inquiry in grid view. The initial default is list view.'\n          )\n        }}\n      </div>\n    </div>\n\n    <div class=\"user_settings\">\n      <NcCheckboxRadioSwitch\n        v-model=\"preferencesStore.user.verboseInquiriesList\"\n        type=\"switch\"\n        @update:model-value=\"preferencesStore.write()\"\n      >\n        {{ t('agora', 'Verbose inquiry list') }}\n      </NcCheckboxRadioSwitch>\n      <div class=\"settings_details\">\n        {{ t('agora', 'Check this for more inquiry information in the overview.') }}\n      </div>\n    </div>\n\n    <div class=\"user_settings\">\n      <InputDiv\n        v-model=\"preferencesStore.user.relevantOffset\"\n        type=\"number\"\n        inputmode=\"numeric\"\n        use-num-modifiers\n        :label=\"\n          t(\n            'agora',\n            'Enter the amount of days, inquiries without activity stay in the relevant list:'\n          )\n        \"\n        @change=\"preferencesStore.write()\"\n      />\n    </div>\n  </div>\n</template>\n","<!--\n  - SPDX-FileCopyrightText: 2018 Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n\n<script setup>\nimport { t } from '@nextcloud/l10n'\n\nimport NcCheckboxRadioSwitch from '@nextcloud/vue/components/NcCheckboxRadioSwitch'\n\nimport { usePreferencesStore } from '../../../stores/preferences.ts'\nconst preferencesStore = usePreferencesStore()\n</script>\n\n<template>\n  <div>\n    <b> {{ t('agora', 'The style settings are still experimental!') }}</b>\n\n    <div class=\"user_settings\">\n      <NcCheckboxRadioSwitch\n        v-model=\"preferencesStore.user.useNewInquiryDialogInNavigation\"\n        type=\"switch\"\n        @update:model-value=\"preferencesStore.write()\"\n      >\n        {{\n          t('agora', \"Use modal 'Add inquiry ' dialog instead of embedded dialog in Navigation bar\")\n        }}\n      </NcCheckboxRadioSwitch>\n    </div>\n\n    <div class=\"user_settings\">\n      <NcCheckboxRadioSwitch\n        v-model=\"preferencesStore.user.useNewInquiryInInquiryist\"\n        type=\"switch\"\n        @update:model-value=\"preferencesStore.write()\"\n      >\n        {{\n          t(\n            'agora',\n            \"Use 'Add inquiry ' as button in inquiry list instead of inside the navigation\"\n          )\n        }}\n      </NcCheckboxRadioSwitch>\n    </div>\n\n    <div class=\"user_settings\">\n      <NcCheckboxRadioSwitch\n        v-model=\"preferencesStore.user.useCommentsAlternativeStyling\"\n        type=\"switch\"\n        @update:model-value=\"preferencesStore.write()\"\n      >\n        {{ t('agora', 'Use alternative styling for the comments sidebar') }}\n      </NcCheckboxRadioSwitch>\n    </div>\n    <div class=\"user_settings\">\n      <NcCheckboxRadioSwitch\n        v-model=\"preferencesStore.user.useAlternativeStyling\"\n        type=\"switch\"\n        @update:model-value=\"preferencesStore.write()\"\n      >\n        {{ t('agora', 'Use alternative inquiry page styling') }}\n      </NcCheckboxRadioSwitch>\n    </div>\n  </div>\n</template>\n"],"names":["usePreferencesStore","defineStore","state","payload","calendar","index","viewMode","response","UserSettingsAPI","error","Logger","CalendarAPI","preferencesStore","defaultViewInquiry","computed","value","_createElementBlock","_createElementVNode","_hoisted_1","_createVNode","_unref","NcCheckboxRadioSwitch","$event","_cache","t","_hoisted_2","_toDisplayString","_hoisted_3","_hoisted_4","_hoisted_5","InputDiv"],"mappings":"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"}